requires:
  min-version: 5
  features:
    - HAVE_LIBJANSSON

args:
- -k none

checks:
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 14
      dnp3.application.control.uns: false
      dnp3.application.function_code: 25
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 70
      dnp3.application.objects[0].points[0].authentication_key: 0
      dnp3.application.objects[0].points[0].created: 0
      dnp3.application.objects[0].points[0].file_size: 0
      dnp3.application.objects[0].points[0].filename: ./test.xml
      dnp3.application.objects[0].points[0].filename_offset: 26
      dnp3.application.objects[0].points[0].filename_size: 10
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].maximum_block_size: 1024
      dnp3.application.objects[0].points[0].operational_mode: 1
      dnp3.application.objects[0].points[0].permissions: 0
      dnp3.application.objects[0].points[0].prefix: 36
      dnp3.application.objects[0].points[0].request_id: 4
      dnp3.application.objects[0].points[0].size: 36
      dnp3.application.objects[0].prefix_code: 5
      dnp3.application.objects[0].qualifier: 91
      dnp3.application.objects[0].range_code: 11
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 3
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 4
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 5
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 14
      dnp3.application.control.uns: false
      dnp3.application.function_code: 129
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 70
      dnp3.application.objects[0].points[0].file_handle: 305419896
      dnp3.application.objects[0].points[0].file_size: 830
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].maximum_block_size: 1024
      dnp3.application.objects[0].points[0].optional_text: ''
      dnp3.application.objects[0].points[0].prefix: 13
      dnp3.application.objects[0].points[0].request_id: 4
      dnp3.application.objects[0].points[0].size: 13
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].prefix_code: 5
      dnp3.application.objects[0].qualifier: 91
      dnp3.application.objects[0].range_code: 11
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 4
      dnp3.control.dir: false
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 3
      dnp3.iin.indicators[0]: need_time
      dnp3.src: 4
      dnp3.type: response
      event_type: dnp3
      pcap_cnt: 7
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 15
      dnp3.application.control.uns: false
      dnp3.application.function_code: 1
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 70
      dnp3.application.objects[0].points[0].block_number: 0
      dnp3.application.objects[0].points[0].file_data: ''
      dnp3.application.objects[0].points[0].file_handle: 305419896
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].prefix: 8
      dnp3.application.objects[0].points[0].size: 8
      dnp3.application.objects[0].prefix_code: 5
      dnp3.application.objects[0].qualifier: 91
      dnp3.application.objects[0].range_code: 11
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 5
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 4
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 8
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 0
      dnp3.application.control.uns: false
      dnp3.application.function_code: 2
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 50
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].prefix: 0
      dnp3.application.objects[0].points[0].timestamp: 1324573673682
      dnp3.application.objects[0].prefix_code: 0
      dnp3.application.objects[0].qualifier: 7
      dnp3.application.objects[0].range_code: 7
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 1
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 4
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 19
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 0
      dnp3.application.control.uns: false
      dnp3.application.function_code: 129
      dnp3.control.dir: false
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 3
      dnp3.src: 4
      dnp3.type: response
      event_type: dnp3
      pcap_cnt: 21
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 1
      dnp3.application.control.uns: false
      dnp3.application.function_code: 2
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 50
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].prefix: 0
      dnp3.application.objects[0].points[0].timestamp: 1324573673780
      dnp3.application.objects[0].prefix_code: 0
      dnp3.application.objects[0].qualifier: 7
      dnp3.application.objects[0].range_code: 7
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 1
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 4
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 22
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 1
      dnp3.application.control.uns: false
      dnp3.application.function_code: 129
      dnp3.control.dir: false
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 3
      dnp3.src: 4
      dnp3.type: response
      event_type: dnp3
      pcap_cnt: 24
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 2
      dnp3.application.control.uns: false
      dnp3.application.function_code: 26
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 70
      dnp3.application.objects[0].points[0].file_handle: 305419896
      dnp3.application.objects[0].points[0].file_size: 0
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].maximum_block_size: 0
      dnp3.application.objects[0].points[0].optional_text: ''
      dnp3.application.objects[0].points[0].prefix: 13
      dnp3.application.objects[0].points[0].request_id: 5
      dnp3.application.objects[0].points[0].size: 13
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].prefix_code: 5
      dnp3.application.objects[0].qualifier: 91
      dnp3.application.objects[0].range_code: 11
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 4
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 4
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 25
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 2
      dnp3.application.control.uns: false
      dnp3.application.function_code: 129
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 70
      dnp3.application.objects[0].points[0].file_handle: 305419896
      dnp3.application.objects[0].points[0].file_size: 0
      dnp3.application.objects[0].points[0].index: 0
      dnp3.application.objects[0].points[0].maximum_block_size: 0
      dnp3.application.objects[0].points[0].optional_text: ''
      dnp3.application.objects[0].points[0].prefix: 13
      dnp3.application.objects[0].points[0].request_id: 5
      dnp3.application.objects[0].points[0].size: 13
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].prefix_code: 5
      dnp3.application.objects[0].qualifier: 91
      dnp3.application.objects[0].range_code: 11
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 4
      dnp3.control.dir: false
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 3
      dnp3.src: 4
      dnp3.type: response
      event_type: dnp3
      pcap_cnt: 27
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
- filter:
    count: 1
    match:
      app_proto: dnp3
      dest_ip: 130.126.140.229
      dest_port: 20000
      event_type: flow
      flow.age: 15
      flow.alerted: false
      flow.bytes_toclient: 2042
      flow.bytes_toserver: 943
      flow.pkts_toclient: 17
      flow.pkts_toserver: 13
      flow.reason: shutdown
      flow.state: closed
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 50276
      tcp.ack: true
      tcp.fin: true
      tcp.psh: true
      tcp.state: closed
      tcp.syn: true
      tcp.tcp_flags: 1b
      tcp.tcp_flags_tc: 1b
      tcp.tcp_flags_ts: 1b
