requires:
  features:
    - HAVE_LIBJANSSON
    - LIBNET1.1

args:
- --simulate-ips

checks:
  - filter:
      lt-version: 7
      count: 1
      match:
        event_type: alert
        alert.action: blocked
        alert.signature_id: 1
        pcap_cnt: 4
  - filter:
      lt-version: 7
      count: 1
      match:
        event_type: alert
        alert.action: blocked
        alert.signature_id: 2
        pcap_cnt: 4
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: alert
        alert.signature_id: 1
        pcap_cnt: 4
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: alert
        alert.signature_id: 2
        pcap_cnt: 4
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 4
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 5
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 6
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 7
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 8
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 9
        verdict.action: drop
  - filter:
      min-version: 7
      count: 1
      match:
        event_type: drop
        pcap_cnt: 10
        verdict.action: drop
  - filter:
      min-version: 7
      count: 0
      match:
        event_type: alert
        alert.signature_id: 3
        verdict.action: alert

  - filter:
      lt-version: 7
      count: 1
      match:
        event_type: drop
        alert.action: blocked
        alert.signature_id: 1
        pcap_cnt: 4
  - filter:
      lt-version: 7
      count: 1
      match:
        event_type: drop
        alert.signature_id: 1
        pcap_cnt: 4
  - filter:
      count: 1
      match:
        event_type: drop
        pcap_cnt: 5
  - filter:
      count: 1
      match:
        event_type: drop
        pcap_cnt: 6
  - filter:
      count: 1
      match:
        event_type: drop
        pcap_cnt: 7
  - filter:
      count: 1
      match:
        event_type: drop
        pcap_cnt: 8
  - filter:
      count: 1
      match:
        event_type: drop
        pcap_cnt: 9
  - filter:
      count: 1
      match:
        event_type: drop
        pcap_cnt: 10
