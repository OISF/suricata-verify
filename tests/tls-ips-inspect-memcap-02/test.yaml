pcap: ../tls-ja3s/input.pcap
args:
- --simulate-ips
- -k none
- --simulate-packet-tcp-memcap=4 # pretend tcp memcap was hit in packet 4, the client hello containing the sni
- --set stream.drop-on-memcap-reached=true
checks:
  - filter:
      count: 0
      match:
        event_type: alert
  - filter:
      count: 29
      match:
        event_type: drop
  - filter:
      count: 1
      match:
        event_type: drop
        drop.reason: "stream memcap"
  - filter:
      count: 28
      match:
        event_type: drop
        drop.reason: "flow drop"
  - filter:
      count: 0
      match:
        event_type: tls
        tls.sni: example.com
  - filter:
      count: 0
      match:
        event_type: tls
  - filter:
      count: 0
      match:
        event_type: flow
        app_proto: tls
  - filter:
      count: 1
      match:
        event_type: flow
        flow.action: drop
