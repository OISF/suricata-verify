requires:
  version: 7

command: |
  ${SRCDIR}/src/suricata --set threshold-file="${TEST_DIR}/threshold.config" --set classification-file="${TEST_DIR}/classification.config" --set reference-config-file="${SRCDIR}/etc/reference.config" -l ${OUTPUT_DIR} -c ${SRCDIR}/suricata.yaml -S ${TEST_DIR}/emerging-all.rules --set logging.outputs.1.file.type=json --set logging.outputs.1.file.filename=suricata.json -T

exit-code: 1

checks:

  - filter:
      filename: suricata.json
      count: 2
      match:
        engine.error_code: 39
        engine.error: "SC_ERR_INVALID_SIGNATURE"
