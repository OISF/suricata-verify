requires:
  features:
    - HAVE_NSS
    - HAVE_LIBJANSSON
  files:
    - src/output-filestore.c

pcap: ../filestore-v2.1-forced/suricata-update-pdf.pcap

checks:

  - filter:
      filename: "filestore/48/48d179a2f8d17331446c7a75a082851eee9ad841705ed5fbce730f51a0598d62.1515441287.1.json"
      count: 1
      match:
        fileinfo.sha256: 48d179a2f8d17331446c7a75a082851eee9ad841705ed5fbce730f51a0598d62

  - filter:
      filename: "filestore/48/48d179a2f8d17331446c7a75a082851eee9ad841705ed5fbce730f51a0598d62.1515441287.1.json"
      count: 1
      match:
        fileinfo.stored: true
      

  - filter:
      filename: "filestore/48/48d179a2f8d17331446c7a75a082851eee9ad841705ed5fbce730f51a0598d62.1515441287.1.json"
      count: 1
      match:
        has-key: flow_id
