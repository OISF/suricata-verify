requires:
  features:
    - HAVE_LIBJANSSON

checks:
  - filter:
      # The number of records this filter should match.
      count: 1
      # The fields to match on.
      match:
        event_type: flow
        flow.etm.pcr: 1
        flow.etm.bd_mean: 102.80609130859375
        flow.etm.bd_variance: 78.7375259399414
        flow.etm.entropy: 7.63106632232666
        flow.etm.dir.__len: 10
        flow.etm.delta.__len: 10
        flow.etm.len.__len: 10
        has-key: flow.etm

# Add additional arguments to Suricata.
args:
  - --set encrypted-traffic-metadata.enabled=yes
