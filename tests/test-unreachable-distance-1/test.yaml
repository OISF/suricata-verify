requires:
  min-version: 7

checks:
    - shell:
        args: grep "signature can't match" suricata.log | wc -l | xargs
        expect: 2

    - shell:
        args: grep SC_ERR_INVALID_SIGNATURE suricata.log | wc -l | xargs
        expect: 4

    - shell:
        args: grep "1 rule files processed. 1 rules successfully loaded, 2 rules failed" suricata.log | wc -l | xargs
        expect: 1

exit-code: 1
