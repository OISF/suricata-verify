requires:
  min-version: 5
  features:
    - HAVE_LIBJANSSON

args:
- -k none

checks:
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 7
      dnp3.application.control.uns: false
      dnp3.application.function_code: 3
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 12
      dnp3.application.objects[0].points[0].count: 1
      dnp3.application.objects[0].points[0].cr: 0
      dnp3.application.objects[0].points[0].index: 1
      dnp3.application.objects[0].points[0].offtime: 100
      dnp3.application.objects[0].points[0].ontime: 100
      dnp3.application.objects[0].points[0].op_type: 3
      dnp3.application.objects[0].points[0].prefix: 1
      dnp3.application.objects[0].points[0].qu: 0
      dnp3.application.objects[0].points[0].reserved: 0
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].points[0].tcc: 0
      dnp3.application.objects[0].prefix_code: 2
      dnp3.application.objects[0].qualifier: 40
      dnp3.application.objects[0].range_code: 8
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 1
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 2
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 5
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 49404
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 7
      dnp3.application.control.uns: false
      dnp3.application.function_code: 129
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 12
      dnp3.application.objects[0].points[0].count: 1
      dnp3.application.objects[0].points[0].cr: 0
      dnp3.application.objects[0].points[0].index: 1
      dnp3.application.objects[0].points[0].offtime: 100
      dnp3.application.objects[0].points[0].ontime: 100
      dnp3.application.objects[0].points[0].op_type: 3
      dnp3.application.objects[0].points[0].prefix: 1
      dnp3.application.objects[0].points[0].qu: 0
      dnp3.application.objects[0].points[0].reserved: 0
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].points[0].tcc: 0
      dnp3.application.objects[0].prefix_code: 2
      dnp3.application.objects[0].qualifier: 40
      dnp3.application.objects[0].range_code: 8
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 1
      dnp3.control.dir: false
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 3
      dnp3.src: 2
      dnp3.type: response
      event_type: dnp3
      pcap_cnt: 7
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 49404
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 8
      dnp3.application.control.uns: false
      dnp3.application.function_code: 4
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 12
      dnp3.application.objects[0].points[0].count: 1
      dnp3.application.objects[0].points[0].cr: 0
      dnp3.application.objects[0].points[0].index: 1
      dnp3.application.objects[0].points[0].offtime: 100
      dnp3.application.objects[0].points[0].ontime: 100
      dnp3.application.objects[0].points[0].op_type: 3
      dnp3.application.objects[0].points[0].prefix: 1
      dnp3.application.objects[0].points[0].qu: 0
      dnp3.application.objects[0].points[0].reserved: 0
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].points[0].tcc: 0
      dnp3.application.objects[0].prefix_code: 2
      dnp3.application.objects[0].qualifier: 40
      dnp3.application.objects[0].range_code: 8
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 1
      dnp3.control.dir: true
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 2
      dnp3.src: 3
      dnp3.type: request
      event_type: dnp3
      pcap_cnt: 8
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 49404
- filter:
    count: 1
    match:
      dest_ip: 130.126.140.229
      dest_port: 20000
      dnp3.application.complete: true
      dnp3.application.control.con: false
      dnp3.application.control.fin: true
      dnp3.application.control.fir: true
      dnp3.application.control.sequence: 8
      dnp3.application.control.uns: false
      dnp3.application.function_code: 129
      dnp3.application.objects[0].count: 1
      dnp3.application.objects[0].group: 12
      dnp3.application.objects[0].points[0].count: 1
      dnp3.application.objects[0].points[0].cr: 0
      dnp3.application.objects[0].points[0].index: 1
      dnp3.application.objects[0].points[0].offtime: 100
      dnp3.application.objects[0].points[0].ontime: 100
      dnp3.application.objects[0].points[0].op_type: 3
      dnp3.application.objects[0].points[0].prefix: 1
      dnp3.application.objects[0].points[0].qu: 0
      dnp3.application.objects[0].points[0].reserved: 0
      dnp3.application.objects[0].points[0].status_code: 0
      dnp3.application.objects[0].points[0].tcc: 0
      dnp3.application.objects[0].prefix_code: 2
      dnp3.application.objects[0].qualifier: 40
      dnp3.application.objects[0].range_code: 8
      dnp3.application.objects[0].start: 0
      dnp3.application.objects[0].stop: 0
      dnp3.application.objects[0].variation: 1
      dnp3.control.dir: false
      dnp3.control.fcb: false
      dnp3.control.fcv: false
      dnp3.control.function_code: 4
      dnp3.control.pri: true
      dnp3.dst: 3
      dnp3.src: 2
      dnp3.type: response
      event_type: dnp3
      pcap_cnt: 10
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 49404
- filter:
    count: 1
    match:
      app_proto: dnp3
      dest_ip: 130.126.140.229
      dest_port: 20000
      event_type: flow
      flow.age: 8
      flow.alerted: false
      flow.bytes_toclient: 464
      flow.bytes_toserver: 424
      flow.pkts_toclient: 7
      flow.pkts_toserver: 6
      flow.reason: shutdown
      flow.state: closed
      proto: TCP
      src_ip: 130.126.142.250
      src_port: 49404
      tcp.ack: true
      tcp.fin: true
      tcp.psh: true
      tcp.state: closed
      tcp.syn: true
      tcp.tcp_flags: 1b
      tcp.tcp_flags_tc: 1b
      tcp.tcp_flags_ts: 1b
