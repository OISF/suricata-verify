requires:
  features:
    - HAVE_LIBJANSSON
    - RUST

# disables checksum verification
args:
- -k none

checks:
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 1

  - filter:
      count: 6 # TS only right now
      match:
        event_type: record
        record.type: "smb1.hdr"
  - filter:
      count: 1
      match:
        event_type: record
        record.type: "smb1.hdr"
        record.offset: 4
        record.length: 32
        record.payload: "/1NNQnIAAAAAGEPIAAAAAAAAAAAAAAAAAAD+/wAAAAA="
  - filter:
      count: 1
      match:
        event_type: record
        record.type: "smb1.hdr"
        record.offset: 1098
        record.length: 32
        record.payload: "/1NNQnEAAAAAGEPIAAAAAAAAAAAAAAAAAQhkBgAQBQA="
