#Commencing packet processing (pid=1350)
#10/14-10:53:45.850183  [**] [1:46468:1] SERVER-OTHER Cisco Smart Install invalid init discovery message denial of service attempt [**] [Priority: 0] {TCP} 108.61.166.245:56882 -> 197.243.44.37:4786
#10/14-10:53:45.850183  [**] [1:46096:2] SERVER-OTHER Cisco Smart Install init discovery message stack buffer overflow attempt [**] [Priority: 0] {TCP} 108.61.166.245:56882 -> 197.243.44.37:4786

# rules by Talos
alert tcp any any -> any 4786 (msg:"SERVER-OTHER Cisco Smart Install init discovery message stack buffer overflow attempt"; flow:to_server,established; content:"|00 00 00|"; depth:3; content:"|00 00 00 07|"; within:4; distance:5; fast_pattern; content:"|00 00 00 01|"; within:4; distance:4; byte_test:4,>,28,0,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2018-0171; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2; sid:46096; rev:2;)

alert tcp any any -> any 4786 (msg:"SERVER-OTHER Cisco Smart Install invalid init discovery message denial of service attempt"; flow:to_server,established; content:"|00 00 00|"; depth:3; content:"|00 00 00 07|"; within:4; distance:5; fast_pattern; content:"|00 00 00 01|"; within:4; distance:4; byte_math:bytes 4,offset 0,oper +,rvalue 8,result sub_len_plus_eight,relative; byte_test:4,!=,sub_len_plus_eight,-8,relative; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:cve,2018-0171; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi2; sid:46468; rev:1;)
