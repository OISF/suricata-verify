requires:
  features:
    - HAVE_LIBJANSSON

checks:
  - filter:
      # The number of records this filter should match.
      count: 1
      # The fields to match on.
      match:
        event_type: flow
        flow.etm.pcr: 0
        flow.etm.bd_mean: 45.97979736328125
        flow.etm.bd_variance: 483503.90625
        flow.etm.entropy: 0
        flow.etm.dir.__len: 1
        flow.etm.delta.__len: 1
        flow.etm.len.__len: 1
        has-key: flow.etm

# Add additional arguments to Suricata.
args:
  - --set encrypted-traffic-metadata.enabled=yes
