requires:
  min-version: 8

args:
 - -k none --set datasets.enabled=yes

checks:
  - filter:
      count: 4
      match:
        event_type: alert
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 1
        alert.extra.src_ip.test: success
        alert.extra.bad_host.year: 2005
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 2
        alert.extra.src_ip.test: success
        alert.extra.dbad_host.year: 2005
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 3
        alert.extra.src_ip.test: success
        alert.extra.nbad_host.year: 2005
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 4
        alert.extra.src_ip.test: success
        alert.extra.nkbad_host.year: 2005
        alert.extra.nkbad_host.host.domain: testmyids.com
