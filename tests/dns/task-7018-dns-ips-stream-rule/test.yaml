args:
- -k none
- --set detect.guess-applayer-tx=true

env:
  SURICATA_EVE_DNS_VERSION: 2

pcap: ../task-7018-ids-dns-keywords/input.pcap

checks:
- filter:
    count: 2
    match:
      event_type: alert
- filter:
    count: 1
    match:
      event_type: alert
      alert.signature_id: 1
- filter:
    count: 1
    match:
      event_type: alert
      alert.signature_id: 1
      dns.type: response
      dns.queries[0].rrname: suricata.io
      dns.queries[0].rrtype: A
      dns.answers[0].rrname: suricata.io
      dns.answers[0].rrtype: A
      dns.answers[0].ttl: 600
      dns.answers[0].rdata: 35.212.0.44
- filter:
    count: 1
    match:
      event_type: alert
      alert.signature_id: 2
- filter:
    count: 1
    match:
      event_type: alert
      alert.signature_id: 2
      dns.type: request
      dns.queries[0].rrname: suricata.io
      dns.queries[0].rrtype: A

