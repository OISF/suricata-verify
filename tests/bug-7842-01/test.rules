alert http any any -> any any (flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|27|"; base64_decode:relative; base64_data; content:"|ff ff ff ff|"; within:16; content:".PSObject"; distance:0; content:"|2f|RunspaceInvoke"; sid:2;)

alert http any any -> any any (flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|27|"; base64_decode:relative; base64_data; content:"|ff 01|"; within:2; content:".PSObject"; distance:0; content:"|2f|RunspaceInvoke"; sid:3;)

# strict depth version
alert http any any -> any any (flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|27|"; base64_decode:relative; base64_data; content:"|00 01 00 00 00 ff ff ff ff|"; depth:9; content:".PSObject"; distance:0; content:"|2f|RunspaceInvoke"; sid:11;)
# strict within version
alert http any any -> any any (flow:established,to_server; http.method; content:"POST"; http.request_body; content:"|27|"; base64_decode:relative; base64_data; content:"|00 01 00 00 00 ff ff ff ff|"; within:9; content:".PSObject"; distance:0; content:"|2f|RunspaceInvoke"; sid:12;)
