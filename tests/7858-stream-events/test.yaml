args:
- --set stats.decoder-events=true
- --set stats.stream-events=true

requires:
  min-version: 9.0

pcap: ../bug-3286-02-linux-evasion/with_evasion_linux.pcap

checks:
  - filter:
      count: 3
      match:
        event_type: alert
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 1
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 2210044
        pcap_cnt: 2
  - filter:
      count: 1
      match:
        event_type: alert
        alert.signature_id: 2210044
        pcap_cnt: 3
  - filter:
      count: 1
      match:
        event_type: fileinfo
        fileinfo.state: CLOSED
  - filter:
      count: 1
      match:
        event_type: http
        http.status: 200
        http.length: 14
  - filter:
      count: 1
      match:
        event_type: stats
        stats.stream.pkt_invalid_timestamp: 2
